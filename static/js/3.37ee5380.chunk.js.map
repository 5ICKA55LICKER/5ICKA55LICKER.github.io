{"version":3,"sources":["../../../src/parseAssetId.ts","../../../src/parseSource.ts","../../../src/urlForImage.ts","../../../src/builder.ts","../node_modules/@sanity/block-content-to-hyperscript/internals.js","../../src/getImageUrl.js","../../src/mergeSerializers.js","../../src/BlockContent.js","../../src/internals.js","../../src/serializers.js","../node_modules/@sanity/block-content-to-hyperscript/node_modules/@sanity/generate-help-url/index.js","../../src/blocksToNodes.js","../../src/buildMarksTree.js","../../src/nestLists.js","../../src/generateKeys.js","../../../src/targets/dom.js"],"names":["example","parseSource","source","src","test","image","asset","_ref","urlToId","isAsset","isAssetStub","img","result","left","top","bottom","right","x","y","height","width","applyDefaults","url","SPEC_NAME_TO_URL_NAME_MAPPINGS","urlForImage","options","spec","ref","id","dimensionString","format","Error","imgWidthStr","imgHeightStr","isFinite","parseAssetId","cropLeft","Math","cropTop","crop","hotSpotVerticalRadius","hotSpotHorizontalRadius","hotSpotCenterX","hotSpotCenterY","hotspot","imgWidth","imgHeight","rect","desiredAspectRatio","cropRect","fit","cdnUrl","filename","baseUrl","params","flip","specName","mapping","param","encodeURIComponent","specToImageUrl","validFits","validCrops","validAutoModes","entry","key","ImageUrlBuilder","this","parent","withOptions","newOptions","rewriteSpecName","dataset","projectId","bg","dpr","focalPoint","maxWidth","minWidth","maxHeight","minHeight","size","blur","sharpen","invert","orientation","quality","forceDownload","download","flipHorizontal","flipVertical","ignoreImageParams","value","saturation","auto","toString","client","isSanityClient","apiUrl","apiHost","module","exports","require","generateHelpUrl","urlBuilder","objectAssign","enc","materializeError","props","node","query","keys","Object","getQueryString","defaultSerializers","userSerializers","type","acc","isDefined","React","PropTypes","internals","serializers","serializeSpan","renderProps","getImageUrl","blocksToNodes","mergeSerializers","renderNode","SanityBlockContent","customSerializers","blockProps","assign","blocks","className","renderContainerOnSingleChild","imageOptions","shape","types","marks","list","listItem","block","span","func","oneOfType","arrayOf","_type","isRequired","getSerializers","serializeOptions","serializerOpts","useDashedStyles","h","tag","style","strong","RawMarkSerializer","em","code","underline","textDecoration","link","href","children","isInline","blockType","serializer","mark","markType","console","hardBreak","container","markFallback","text","empty","serializedNode","slug","buildMarksTree","nestLists","generateKeys","optionProps","defaults","isListItem","properties","rawBlocks","Array","keyedBlocks","opts","level","serializeList","tree","index","serializeListItem","i","siblings","findListItemIndex","isSpan","serializeNode","serializeBlock","Boolean","nodes","containerProps","defaultMarks","sortMarksByOccurences","spans","markOccurences","occurences","siblingIndex","sibling","sortByOccurence","sortMarks","markA","markB","aOccurences","bOccurences","aDefaultPos","bDefaultPos","markDefs","sortedMarks","rootNode","nodeStack","marksNeeded","pos","currentNode","findLastParentNode","_key","def","markKey","lines","line","lastNode","isListBlock","blockMatchesList","listFromBlock","lastChild","findListMatching","matching","filterOnType","mode","currentList","newList","lastListItem","newLastChild","match","checksum","str","hash","strlen","item","JSON","nestMarks"],"mappings":"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","file":"static/js/3.37ee5380.chunk.js","sourcesContent":["const example = 'image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg'\n\nexport default function parseAssetId(ref: string) {\n  const [, id, dimensionString, format] = ref.split('-')\n\n  if (!id || !dimensionString || !format) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  const [imgWidthStr, imgHeightStr] = dimensionString.split('x')\n\n  const width = +imgWidthStr\n  const height = +imgHeightStr\n\n  const isValidAssetId = isFinite(width) && isFinite(height)\n  if (!isValidAssetId) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  return {id, width, height, format}\n}\n","import {\n  SanityAsset,\n  SanityImageObject,\n  SanityImageSource,\n  SanityImageWithAssetStub,\n  SanityReference,\n} from './types'\n\nconst isRef = (src: SanityImageSource): src is SanityReference => {\n  const source = src as SanityReference\n  return source ? typeof source._ref === 'string' : false\n}\n\nconst isAsset = (src: SanityImageSource): src is SanityAsset => {\n  const source = src as SanityAsset\n  return source ? typeof source._id === 'string' : false\n}\n\nconst isAssetStub = (src: SanityImageSource): src is SanityImageWithAssetStub => {\n  const source = src as SanityImageWithAssetStub\n  return source && source.asset ? typeof source.asset.url === 'string' : false\n}\n\n// Convert an asset-id, asset or image to an image record suitable for processing\n// eslint-disable-next-line complexity\nexport default function parseSource(source?: SanityImageSource) {\n  if (!source) {\n    return null\n  }\n\n  let image: SanityImageObject\n\n  if (typeof source === 'string' && isUrl(source)) {\n    // Someone passed an existing image url?\n    image = {\n      asset: {_ref: urlToId(source)},\n    }\n  } else if (typeof source === 'string') {\n    // Just an asset id\n    image = {\n      asset: {_ref: source},\n    }\n  } else if (isRef(source)) {\n    // We just got passed an asset directly\n    image = {\n      asset: source,\n    }\n  } else if (isAsset(source)) {\n    // If we were passed an image asset document\n    image = {\n      asset: {\n        _ref: source._id || '',\n      },\n    }\n  } else if (isAssetStub(source)) {\n    // If we were passed a partial asset (`url`, but no `_id`)\n    image = {\n      asset: {\n        _ref: urlToId(source.asset.url),\n      },\n    }\n  } else if (typeof source.asset === 'object') {\n    // Probably an actual image with materialized asset\n    image = source\n  } else {\n    // We got something that does not look like an image, or it is an image\n    // that currently isn't sporting an asset.\n    return null\n  }\n\n  const img = source as SanityImageObject\n  if (img.crop) {\n    image.crop = img.crop\n  }\n\n  if (img.hotspot) {\n    image.hotspot = img.hotspot\n  }\n\n  return applyDefaults(image)\n}\n\nfunction isUrl(url: string) {\n  return /^https?:\\/\\//.test(`${url}`)\n}\n\nfunction urlToId(url: string) {\n  const parts = url.split('/').slice(-1)\n  return `image-${parts[0]}`.replace(/\\.([a-z]+)$/, '-$1')\n}\n\n// Mock crop and hotspot if image lacks it\nfunction applyDefaults(image: SanityImageObject) {\n  if (image.crop && image.hotspot) {\n    return image as Required<SanityImageObject>\n  }\n\n  // We need to pad in default values for crop or hotspot\n  const result = {...image}\n\n  if (!result.crop) {\n    result.crop = {\n      left: 0,\n      top: 0,\n      bottom: 0,\n      right: 0,\n    }\n  }\n\n  if (!result.hotspot) {\n    result.hotspot = {\n      x: 0.5,\n      y: 0.5,\n      height: 1.0,\n      width: 1.0,\n    }\n  }\n\n  return result as Required<SanityImageObject>\n}\n","import parseAssetId from './parseAssetId'\nimport parseSource from './parseSource'\nimport {\n  CropSpec,\n  HotspotSpec,\n  ImageUrlBuilderOptions,\n  ImageUrlBuilderOptionsWithAsset,\n  SanityAsset,\n  SanityImageFitResult,\n  SanityImageRect,\n  SanityReference,\n} from './types'\n\nexport const SPEC_NAME_TO_URL_NAME_MAPPINGS = [\n  ['width', 'w'],\n  ['height', 'h'],\n  ['format', 'fm'],\n  ['download', 'dl'],\n  ['blur', 'blur'],\n  ['sharpen', 'sharp'],\n  ['invert', 'invert'],\n  ['orientation', 'or'],\n  ['minHeight', 'min-h'],\n  ['maxHeight', 'max-h'],\n  ['minWidth', 'min-w'],\n  ['maxWidth', 'max-w'],\n  ['quality', 'q'],\n  ['fit', 'fit'],\n  ['crop', 'crop'],\n  ['saturation', 'sat'],\n  ['auto', 'auto'],\n  ['dpr', 'dpr'],\n]\n\nexport default function urlForImage(options: ImageUrlBuilderOptions) {\n  let spec = {...(options || {})}\n  const source = spec.source\n  delete spec.source\n\n  const image = parseSource(source)\n  if (!image) {\n    return null\n  }\n\n  const id = (image.asset as SanityReference)._ref || (image.asset as SanityAsset)._id || ''\n  const asset = parseAssetId(id)\n\n  // Compute crop rect in terms of pixel coordinates in the raw source image\n  const cropLeft = Math.round(image.crop.left * asset.width)\n  const cropTop = Math.round(image.crop.top * asset.height)\n  const crop = {\n    left: cropLeft,\n    top: cropTop,\n    width: Math.round(asset.width - image.crop.right * asset.width - cropLeft),\n    height: Math.round(asset.height - image.crop.bottom * asset.height - cropTop),\n  }\n\n  // Compute hot spot rect in terms of pixel coordinates\n  const hotSpotVerticalRadius = (image.hotspot.height * asset.height) / 2\n  const hotSpotHorizontalRadius = (image.hotspot.width * asset.width) / 2\n  const hotSpotCenterX = image.hotspot.x * asset.width\n  const hotSpotCenterY = image.hotspot.y * asset.height\n  const hotspot = {\n    left: hotSpotCenterX - hotSpotHorizontalRadius,\n    top: hotSpotCenterY - hotSpotVerticalRadius,\n    right: hotSpotCenterX + hotSpotHorizontalRadius,\n    bottom: hotSpotCenterY + hotSpotVerticalRadius,\n  }\n\n  // If irrelevant, or if we are requested to: don't perform crop/fit based on\n  // the crop/hotspot.\n  if (!(spec.rect || spec.focalPoint || spec.ignoreImageParams || spec.crop)) {\n    spec = {...spec, ...fit({crop, hotspot}, spec)}\n  }\n\n  return specToImageUrl({...spec, asset})\n}\n\n// eslint-disable-next-line complexity\nfunction specToImageUrl(spec: ImageUrlBuilderOptionsWithAsset) {\n  const cdnUrl = spec.baseUrl || 'https://cdn.sanity.io'\n  const filename = `${spec.asset.id}-${spec.asset.width}x${spec.asset.height}.${spec.asset.format}`\n  const baseUrl = `${cdnUrl}/images/${spec.projectId}/${spec.dataset}/${filename}`\n\n  const params = []\n\n  if (spec.rect) {\n    // Only bother url with a crop if it actually crops anything\n    const {left, top, width, height} = spec.rect\n    const isEffectiveCrop =\n      left !== 0 || top !== 0 || height !== spec.asset.height || width !== spec.asset.width\n\n    if (isEffectiveCrop) {\n      params.push(`rect=${left},${top},${width},${height}`)\n    }\n  }\n\n  if (spec.bg) {\n    params.push(`bg=${spec.bg}`)\n  }\n\n  if (spec.focalPoint) {\n    params.push(`fp-x=${spec.focalPoint.x}`)\n    params.push(`fp-y=${spec.focalPoint.y}`)\n  }\n\n  const flip = [spec.flipHorizontal && 'h', spec.flipVertical && 'v'].filter(Boolean).join('')\n  if (flip) {\n    params.push(`flip=${flip}`)\n  }\n\n  // Map from spec name to url param name, and allow using the actual param name as an alternative\n  SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach((mapping) => {\n    const [specName, param] = mapping\n    if (typeof spec[specName] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[specName])}`)\n    } else if (typeof spec[param] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[param])}`)\n    }\n  })\n\n  if (params.length === 0) {\n    return baseUrl\n  }\n\n  return `${baseUrl}?${params.join('&')}`\n}\n\nfunction fit(\n  source: {crop: CropSpec; hotspot: HotspotSpec},\n  spec: ImageUrlBuilderOptions\n): SanityImageFitResult {\n  let cropRect: SanityImageRect\n\n  const imgWidth = spec.width\n  const imgHeight = spec.height\n\n  // If we are not constraining the aspect ratio, we'll just use the whole crop\n  if (!(imgWidth && imgHeight)) {\n    return {width: imgWidth, height: imgHeight, rect: source.crop}\n  }\n\n  const crop = source.crop\n  const hotspot = source.hotspot\n\n  // If we are here, that means aspect ratio is locked and fitting will be a bit harder\n  const desiredAspectRatio = imgWidth / imgHeight\n  const cropAspectRatio = crop.width / crop.height\n\n  if (cropAspectRatio > desiredAspectRatio) {\n    // The crop is wider than the desired aspect ratio. That means we are cutting from the sides\n    const height = crop.height\n    const width = height * desiredAspectRatio\n    const top = crop.top\n\n    // Center output horizontally over hotspot\n    const hotspotXCenter = (hotspot.right - hotspot.left) / 2 + hotspot.left\n    let left = hotspotXCenter - width / 2\n\n    // Keep output within crop\n    if (left < crop.left) {\n      left = crop.left\n    } else if (left + width > crop.left + crop.width) {\n      left = crop.left + crop.width - width\n    }\n\n    cropRect = {\n      left: Math.round(left),\n      top: Math.round(top),\n      width: Math.round(width),\n      height: Math.round(height),\n    }\n  } else {\n    // The crop is taller than the desired ratio, we are cutting from top and bottom\n    const width = crop.width\n    const height = width / desiredAspectRatio\n    const left = crop.left\n\n    // Center output vertically over hotspot\n    const hotspotYCenter = (hotspot.bottom - hotspot.top) / 2 + hotspot.top\n    let top = hotspotYCenter - height / 2\n\n    // Keep output rect within crop\n    if (top < crop.top) {\n      top = crop.top\n    } else if (top + height > crop.top + crop.height) {\n      top = crop.top + crop.height - height\n    }\n\n    cropRect = {\n      left: Math.max(0, Math.floor(left)),\n      top: Math.max(0, Math.floor(top)),\n      width: Math.round(width),\n      height: Math.round(height),\n    }\n  }\n\n  return {\n    width: imgWidth,\n    height: imgHeight,\n    rect: cropRect,\n  }\n}\n\n// For backwards-compatibility\nexport {parseSource}\n","import {\n  AutoMode,\n  CropMode,\n  FitMode,\n  ImageFormat,\n  ImageUrlBuilderOptions,\n  ImageUrlBuilderOptionsWithAliases,\n  Orientation,\n  SanityClient,\n  SanityImageSource,\n  SanityProjectDetails,\n} from './types'\nimport urlForImage, {SPEC_NAME_TO_URL_NAME_MAPPINGS} from './urlForImage'\n\nconst validFits = ['clip', 'crop', 'fill', 'fillmax', 'max', 'scale', 'min']\nconst validCrops = ['top', 'bottom', 'left', 'right', 'center', 'focalpoint', 'entropy']\nconst validAutoModes = ['format']\n\nfunction isSanityClient(client?: SanityClient): client is SanityClient {\n  return client ? typeof client.clientConfig === 'object' : false\n}\n\nfunction rewriteSpecName(key: string) {\n  const specs = SPEC_NAME_TO_URL_NAME_MAPPINGS\n  for (const entry of specs) {\n    const [specName, param] = entry\n    if (key === specName || key === param) {\n      return specName\n    }\n  }\n\n  return key\n}\n\nexport default function urlBuilder(options?: SanityClient | SanityProjectDetails) {\n  // Did we get a SanityClient?\n  const client = options as SanityClient\n  if (isSanityClient(client)) {\n    // Inherit config from client\n    const {apiHost: apiUrl, projectId, dataset} = client.clientConfig\n    const apiHost = apiUrl || 'https://api.sanity.io'\n    return new ImageUrlBuilder(null, {\n      baseUrl: apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n      projectId,\n      dataset,\n    })\n  }\n\n  // Or just accept the options as given\n  return new ImageUrlBuilder(null, options as ImageUrlBuilderOptions)\n}\n\nexport class ImageUrlBuilder {\n  public options: ImageUrlBuilderOptions\n\n  constructor(parent: ImageUrlBuilder | null, options: ImageUrlBuilderOptions) {\n    this.options = parent\n      ? {...(parent.options || {}), ...(options || {})} // Merge parent options\n      : {...(options || {})} // Copy options\n  }\n\n  withOptions(options: Partial<ImageUrlBuilderOptionsWithAliases>) {\n    const baseUrl = options.baseUrl || this.options.baseUrl\n\n    const newOptions: {[key: string]: any} = {baseUrl}\n    for (const key in options) {\n      if (options.hasOwnProperty(key)) {\n        const specKey = rewriteSpecName(key)\n        newOptions[specKey] = options[key]\n      }\n    }\n\n    return new ImageUrlBuilder(this, {baseUrl, ...newOptions})\n  }\n\n  // The image to be represented. Accepts a Sanity 'image'-document, 'asset'-document or\n  // _id of asset. To get the benefit of automatic hot-spot/crop integration with the content\n  // studio, the 'image'-document must be provided.\n  image(source: SanityImageSource) {\n    return this.withOptions({source})\n  }\n\n  // Specify the dataset\n  dataset(dataset: string) {\n    return this.withOptions({dataset})\n  }\n\n  // Specify the projectId\n  projectId(projectId: string) {\n    return this.withOptions({projectId})\n  }\n\n  // Specify background color\n  bg(bg: string) {\n    return this.withOptions({bg})\n  }\n\n  // Set DPR scaling factor\n  dpr(dpr: number) {\n    return this.withOptions({dpr})\n  }\n\n  // Specify the width of the image in pixels\n  width(width: number) {\n    return this.withOptions({width})\n  }\n\n  // Specify the height of the image in pixels\n  height(height: number) {\n    return this.withOptions({height})\n  }\n\n  // Specify focal point in fraction of image dimensions. Each component 0.0-1.0\n  focalPoint(x: number, y: number) {\n    return this.withOptions({focalPoint: {x, y}})\n  }\n\n  maxWidth(maxWidth: number) {\n    return this.withOptions({maxWidth})\n  }\n\n  minWidth(minWidth: number) {\n    return this.withOptions({minWidth})\n  }\n\n  maxHeight(maxHeight: number) {\n    return this.withOptions({maxHeight})\n  }\n\n  minHeight(minHeight: number) {\n    return this.withOptions({minHeight})\n  }\n\n  // Specify width and height in pixels\n  size(width: number, height: number) {\n    return this.withOptions({width, height})\n  }\n\n  // Specify blur between 0 and 100\n  blur(blur: number) {\n    return this.withOptions({blur})\n  }\n\n  sharpen(sharpen: number) {\n    return this.withOptions({sharpen})\n  }\n\n  // Specify the desired rectangle of the image\n  rect(left: number, top: number, width: number, height: number) {\n    return this.withOptions({rect: {left, top, width, height}})\n  }\n\n  // Specify the image format of the image. 'jpg', 'pjpg', 'png', 'webp'\n  format(format: ImageFormat) {\n    return this.withOptions({format})\n  }\n\n  invert(invert: boolean) {\n    return this.withOptions({invert})\n  }\n\n  // Rotation in degrees 0, 90, 180, 270\n  orientation(orientation: Orientation) {\n    return this.withOptions({orientation})\n  }\n\n  // Compression quality 0-100\n  quality(quality: number) {\n    return this.withOptions({quality})\n  }\n\n  // Make it a download link. Parameter is default filename.\n  forceDownload(download: boolean | string) {\n    return this.withOptions({download})\n  }\n\n  // Flip image horizontally\n  flipHorizontal() {\n    return this.withOptions({flipHorizontal: true})\n  }\n\n  // Flip image verically\n  flipVertical() {\n    return this.withOptions({flipVertical: true})\n  }\n\n  // Ignore crop/hotspot from image record, even when present\n  ignoreImageParams() {\n    return this.withOptions({ignoreImageParams: true})\n  }\n\n  fit(value: FitMode) {\n    if (validFits.indexOf(value) === -1) {\n      throw new Error(`Invalid fit mode \"${value}\"`)\n    }\n\n    return this.withOptions({fit: value})\n  }\n\n  crop(value: CropMode) {\n    if (validCrops.indexOf(value) === -1) {\n      throw new Error(`Invalid crop mode \"${value}\"`)\n    }\n\n    return this.withOptions({crop: value})\n  }\n\n  // Saturation\n  saturation(saturation: number) {\n    return this.withOptions({saturation})\n  }\n\n  auto(value: AutoMode) {\n    if (validAutoModes.indexOf(value) === -1) {\n      throw new Error(`Invalid auto mode \"${value}\"`)\n    }\n\n    return this.withOptions({auto: value})\n  }\n\n  // Gets the url based on the submitted parameters\n  url() {\n    return urlForImage(this.options)\n  }\n\n  // Alias for url()\n  toString() {\n    return this.url()\n  }\n}\n","module.exports = require('./lib/internals')\n","const generateHelpUrl = require('@sanity/generate-help-url')\nconst urlBuilder = require('@sanity/image-url')\nconst objectAssign = require('object-assign')\n\nconst enc = encodeURIComponent\nconst materializeError = `You must either:\n  - Pass \\`projectId\\` and \\`dataset\\` to the block renderer\n  - Materialize images to include the \\`url\\` field.\n\nFor more information, see ${generateHelpUrl('block-content-image-materializing')}`\n\nconst getQueryString = options => {\n  const query = options.imageOptions\n  const keys = Object.keys(query)\n  if (!keys.length) {\n    return ''\n  }\n\n  const params = keys.map(key => `${enc(key)}=${enc(query[key])}`)\n  return `?${params.join('&')}`\n}\n\nconst buildUrl = props => {\n  const {node, options} = props\n  const {projectId, dataset} = options\n  const asset = node.asset\n\n  if (!asset) {\n    throw new Error('Image does not have required `asset` property')\n  }\n\n  if (asset.url) {\n    return asset.url + getQueryString(options)\n  }\n\n  if (!projectId || !dataset) {\n    throw new Error(materializeError)\n  }\n\n  const ref = asset._ref\n  if (!ref) {\n    throw new Error('Invalid image reference in block, no `_ref` found on `asset`')\n  }\n\n  return urlBuilder(objectAssign({projectId, dataset}, options.imageOptions || {}))\n    .image(node)\n    .toString()\n}\n\nmodule.exports = buildUrl\n","const objectAssign = require('object-assign')\nconst isDefined = val => typeof val !== 'undefined'\n\n// Recursively merge/replace default serializers with user-specified serializers\nmodule.exports = function mergeSerializers(defaultSerializers, userSerializers) {\n  return Object.keys(defaultSerializers).reduce((acc, key) => {\n    const type = typeof defaultSerializers[key]\n    if (type === 'function') {\n      acc[key] = isDefined(userSerializers[key]) ? userSerializers[key] : defaultSerializers[key]\n    } else if (type === 'object') {\n      acc[key] = objectAssign({}, defaultSerializers[key], userSerializers[key])\n    } else {\n      acc[key] =\n        typeof userSerializers[key] === 'undefined' ? defaultSerializers[key] : userSerializers[key]\n    }\n    return acc\n  }, {})\n}\n","const React = require('react')\nconst PropTypes = require('prop-types')\nconst internals = require('@sanity/block-content-to-hyperscript/internals')\nconst {serializers, serializeSpan, renderProps} = require('./targets/dom')\n\nconst {getImageUrl, blocksToNodes, mergeSerializers} = internals\nconst renderNode = React.createElement\n\nconst SanityBlockContent = props => {\n  const customSerializers = mergeSerializers(\n    SanityBlockContent.defaultSerializers,\n    props.serializers\n  )\n\n  const blockProps = Object.assign({}, renderProps, props, {\n    serializers: customSerializers,\n    blocks: props.blocks || []\n  })\n\n  return blocksToNodes(renderNode, blockProps, serializers, serializeSpan)\n}\n\n// Expose default serializers to the user\nSanityBlockContent.defaultSerializers = serializers\n\n// Expose logic for building image URLs from an image reference/node\nSanityBlockContent.getImageUrl = getImageUrl\n\nSanityBlockContent.propTypes = {\n  className: PropTypes.string,\n  renderContainerOnSingleChild: PropTypes.bool,\n\n  // When rendering images, we need project id and dataset, unless images are materialized\n  projectId: PropTypes.string,\n  dataset: PropTypes.string,\n  imageOptions: PropTypes.object,\n\n  serializers: PropTypes.shape({\n    // Common overrides\n    types: PropTypes.object,\n    marks: PropTypes.object,\n\n    // Less common overrides\n    list: PropTypes.func,\n    listItem: PropTypes.func,\n\n    // Low-level serializers\n    block: PropTypes.func,\n    span: PropTypes.func\n  }),\n\n  blocks: PropTypes.oneOfType([\n    PropTypes.arrayOf(\n      PropTypes.shape({\n        _type: PropTypes.string.isRequired\n      })\n    ),\n    PropTypes.shape({\n      _type: PropTypes.string.isRequired\n    })\n  ]).isRequired\n}\n\nSanityBlockContent.defaultProps = {\n  renderContainerOnSingleChild: false,\n  serializers: {},\n  imageOptions: {}\n}\n\nmodule.exports = SanityBlockContent\n","const getSerializers = require('./serializers')\nconst blocksToNodes = require('./blocksToNodes')\nconst getImageUrl = require('./getImageUrl')\nconst mergeSerializers = require('./mergeSerializers')\n\nmodule.exports = {\n  blocksToNodes: (renderNode, props, defaultSerializers, serializeSpan) => {\n    if (defaultSerializers) {\n      return blocksToNodes(renderNode, props, defaultSerializers, serializeSpan)\n    }\n\n    // Backwards-compatibility\n    const serializers = getSerializers(renderNode)\n    return blocksToNodes(\n      renderNode,\n      props,\n      serializers.defaultSerializers,\n      serializers.serializeSpan\n    )\n  },\n  getSerializers,\n  getImageUrl,\n  mergeSerializers\n}\n","const objectAssign = require('object-assign')\nconst getImageUrl = require('./getImageUrl')\n\nmodule.exports = (h, serializerOpts) => {\n  const serializeOptions = serializerOpts || {useDashedStyles: false}\n\n  // Low-level block serializer\n  function BlockSerializer(props) {\n    const {node, serializers, options, isInline, children} = props\n    const blockType = node._type\n    const serializer = serializers.types[blockType]\n    if (!serializer) {\n      throw new Error(\n        `Unknown block type \"${blockType}\", please specify a serializer for it in the \\`serializers.types\\` prop`\n      )\n    }\n\n    return h(serializer, {node, options, isInline}, children)\n  }\n\n  // Low-level span serializer\n  function SpanSerializer(props) {\n    const {mark, children} = props.node\n    const isPlain = typeof mark === 'string'\n    const markType = isPlain ? mark : mark._type\n    const serializer = props.serializers.marks[markType]\n    if (!serializer) {\n      // @todo Revert back to throwing errors?\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Unknown mark type \"${markType}\", please specify a serializer for it in the \\`serializers.marks\\` prop`\n      )\n      return h(props.serializers.markFallback, null, children)\n    }\n\n    return h(serializer, props.node, children)\n  }\n\n  // Low-level list serializer\n  function ListSerializer(props) {\n    const tag = props.type === 'bullet' ? 'ul' : 'ol'\n    return h(tag, null, props.children)\n  }\n\n  // Low-level list item serializer\n  function ListItemSerializer(props) {\n    const children =\n      !props.node.style || props.node.style === 'normal'\n        ? // Don't wrap plain text in paragraphs inside of a list item\n          props.children\n        : // But wrap any other style in whatever the block serializer says to use\n          h(props.serializers.types.block, props, props.children)\n\n    return h('li', null, children)\n  }\n\n  // Renderer of an actual block of type `block`. Confusing, we know.\n  function BlockTypeSerializer(props) {\n    const style = props.node.style || 'normal'\n\n    if (/^h\\d/.test(style)) {\n      return h(style, null, props.children)\n    }\n\n    return style === 'blockquote'\n      ? h('blockquote', null, props.children)\n      : h('p', null, props.children)\n  }\n\n  // Serializers for things that can be directly attributed to a tag without any props\n  // We use partial application to do this, passing the tag name as the first argument\n  function RawMarkSerializer(tag, props) {\n    return h(tag, null, props.children)\n  }\n\n  function UnderlineSerializer(props) {\n    const style = serializeOptions.useDashedStyles\n      ? {'text-decoration': 'underline'}\n      : {textDecoration: 'underline'}\n\n    return h('span', {style}, props.children)\n  }\n\n  function StrikeThroughSerializer(props) {\n    return h('del', null, props.children)\n  }\n\n  function LinkSerializer(props) {\n    return h('a', {href: props.mark.href}, props.children)\n  }\n\n  function ImageSerializer(props) {\n    if (!props.node.asset) {\n      return null\n    }\n\n    const img = h('img', {src: getImageUrl(props)})\n    return props.isInline ? img : h('figure', null, img)\n  }\n\n  // Serializer that recursively calls itself, producing a hyperscript tree of spans\n  function serializeSpan(span, serializers, index, options) {\n    if (span === '\\n' && serializers.hardBreak) {\n      return h(serializers.hardBreak, {key: `hb-${index}`})\n    }\n\n    if (typeof span === 'string') {\n      return serializers.text ? h(serializers.text, {key: `text-${index}`}, span) : span\n    }\n\n    let children\n    if (span.children) {\n      children = {\n        children: span.children.map((child, i) =>\n          options.serializeNode(child, i, span.children, true)\n        )\n      }\n    }\n\n    const serializedNode = objectAssign({}, span, children)\n\n    return h(serializers.span, {\n      key: span._key || `span-${index}`,\n      node: serializedNode,\n      serializers\n    })\n  }\n\n  const HardBreakSerializer = () => h('br')\n  const defaultMarkSerializers = {\n    strong: RawMarkSerializer.bind(null, 'strong'),\n    em: RawMarkSerializer.bind(null, 'em'),\n    code: RawMarkSerializer.bind(null, 'code'),\n    underline: UnderlineSerializer,\n    'strike-through': StrikeThroughSerializer,\n    link: LinkSerializer\n  }\n\n  const defaultSerializers = {\n    // Common overrides\n    types: {\n      block: BlockTypeSerializer,\n      image: ImageSerializer\n    },\n    marks: defaultMarkSerializers,\n\n    // Less common overrides\n    list: ListSerializer,\n    listItem: ListItemSerializer,\n\n    block: BlockSerializer,\n    span: SpanSerializer,\n    hardBreak: HardBreakSerializer,\n\n    // Container element\n    container: 'div',\n\n    // When we can't resolve the mark properly, use this renderer as the container\n    markFallback: 'span',\n\n    // Allow overriding text renderer, but leave undefined to just use plain strings by default\n    text: undefined,\n\n    // Empty nodes (React uses null, hyperscript with empty strings)\n    empty: ''\n  }\n\n  return {\n    defaultSerializers,\n    serializeSpan\n  }\n}\n","var baseUrl = 'https://docs.sanity.io/help/'\n\nmodule.exports = function generateHelpUrl(slug) {\n  return baseUrl + slug\n}\n","const objectAssign = require('object-assign')\nconst buildMarksTree = require('./buildMarksTree')\nconst nestLists = require('./nestLists')\nconst generateKeys = require('./generateKeys')\nconst mergeSerializers = require('./mergeSerializers')\n\n// Properties to extract from props and pass to serializers as options\nconst optionProps = ['projectId', 'dataset', 'imageOptions']\nconst isDefined = val => typeof val !== 'undefined'\nconst defaults = {imageOptions: {}}\n\nfunction blocksToNodes(h, properties, defaultSerializers, serializeSpan) {\n  const props = objectAssign({}, defaults, properties)\n  const rawBlocks = Array.isArray(props.blocks) ? props.blocks : [props.blocks]\n  const keyedBlocks = generateKeys(rawBlocks)\n  const blocks = nestLists(keyedBlocks, props.listNestMode)\n  const serializers = mergeSerializers(defaultSerializers, props.serializers || {})\n\n  const options = optionProps.reduce((opts, key) => {\n    const value = props[key]\n    if (isDefined(value)) {\n      opts[key] = value\n    }\n    return opts\n  }, {})\n\n  function serializeNode(node, index, siblings, isInline) {\n    if (isList(node)) {\n      return serializeList(node)\n    }\n\n    if (isListItem(node)) {\n      return serializeListItem(node, findListItemIndex(node, siblings))\n    }\n\n    if (isSpan(node)) {\n      return serializeSpan(node, serializers, index, {serializeNode})\n    }\n\n    return serializeBlock(node, index, isInline)\n  }\n\n  function findListItemIndex(node, siblings) {\n    let index = 0\n    for (let i = 0; i < siblings.length; i++) {\n      if (siblings[i] === node) {\n        return index\n      }\n\n      if (!isListItem(siblings[i])) {\n        continue\n      }\n\n      index++\n    }\n\n    return index\n  }\n\n  function serializeBlock(block, index, isInline) {\n    const tree = buildMarksTree(block)\n    const children = tree.map((node, i, siblings) => serializeNode(node, i, siblings, true))\n    const blockProps = {\n      key: block._key || `block-${index}`,\n      node: block,\n      isInline,\n      serializers,\n      options\n    }\n\n    return h(serializers.block, blockProps, children)\n  }\n\n  function serializeListItem(block, index) {\n    const key = block._key\n    const tree = buildMarksTree(block)\n    const children = tree.map(serializeNode)\n    return h(serializers.listItem, {node: block, serializers, index, key, options}, children)\n  }\n\n  function serializeList(list) {\n    const type = list.listItem\n    const level = list.level\n    const key = list._key\n    const children = list.children.map(serializeNode)\n    return h(serializers.list, {key, level, type, options}, children)\n  }\n\n  // Default to false, so `undefined` will evaluate to the default here\n  const renderContainerOnSingleChild = Boolean(props.renderContainerOnSingleChild)\n\n  const nodes = blocks.map(serializeNode)\n  if (renderContainerOnSingleChild || nodes.length > 1) {\n    const containerProps = props.className ? {className: props.className} : {}\n    return h(serializers.container, containerProps, nodes)\n  }\n\n  if (nodes[0]) {\n    return nodes[0]\n  }\n\n  return typeof serializers.empty === 'function' ? h(serializers.empty) : serializers.empty\n}\n\nfunction isList(block) {\n  return block._type === 'list' && block.listItem\n}\n\nfunction isListItem(block) {\n  return block._type === 'block' && block.listItem\n}\n\nfunction isSpan(block) {\n  return typeof block === 'string' || block.marks || block._type === 'span'\n}\n\nmodule.exports = blocksToNodes\n","const defaultMarks = ['strong', 'em', 'code', 'underline', 'strike-through']\n\nconst buildMarksTree = block => {\n  const {children, markDefs} = block\n  if (!children || !children.length) {\n    return []\n  }\n\n  const sortedMarks = children.map(sortMarksByOccurences)\n  const rootNode = {_type: 'span', children: []}\n  let nodeStack = [rootNode]\n\n  children.forEach((span, i) => {\n    const marksNeeded = sortedMarks[i]\n    if (!marksNeeded) {\n      const lastNode = nodeStack[nodeStack.length - 1]\n      lastNode.children.push(span)\n      return\n    }\n\n    let pos = 1\n\n    // Start at position one. Root is always plain and should never be removed. (?)\n    if (nodeStack.length > 1) {\n      for (pos; pos < nodeStack.length; pos++) {\n        const mark = nodeStack[pos].markKey\n        const index = marksNeeded.indexOf(mark)\n        // eslint-disable-next-line max-depth\n        if (index === -1) {\n          break\n        }\n\n        marksNeeded.splice(index, 1)\n      }\n    }\n\n    // Keep from beginning to first miss\n    nodeStack = nodeStack.slice(0, pos)\n\n    // Add needed nodes\n    let currentNode = findLastParentNode(nodeStack)\n    marksNeeded.forEach(mark => {\n      const node = {\n        _type: 'span',\n        _key: span._key,\n        children: [],\n        mark: markDefs.find(def => def._key === mark) || mark,\n        markKey: mark\n      }\n\n      currentNode.children.push(node)\n      nodeStack.push(node)\n      currentNode = node\n    })\n\n    // Split at newlines to make individual line chunks, but keep newline\n    // characters as individual elements in the array. We use these characters\n    // in the span serializer to trigger hard-break rendering\n    if (isTextSpan(span)) {\n      const lines = span.text.split('\\n')\n      for (let line = lines.length; line-- > 1; ) {\n        lines.splice(line, 0, '\\n')\n      }\n\n      currentNode.children = currentNode.children.concat(lines)\n    } else {\n      currentNode.children = currentNode.children.concat(span)\n    }\n  })\n\n  return rootNode.children\n}\n\n// We want to sort all the marks of all the spans in the following order:\n// 1. Marks that are shared amongst the most adjacent siblings\n// 2. Non-default marks (links, custom metadata)\n// 3. Built-in, plain marks (bold, emphasis, code etc)\nfunction sortMarksByOccurences(span, i, spans) {\n  if (!span.marks || span.marks.length === 0) {\n    return span.marks || []\n  }\n\n  const markOccurences = span.marks.reduce((occurences, mark) => {\n    occurences[mark] = occurences[mark] ? occurences[mark] + 1 : 1\n\n    for (let siblingIndex = i + 1; siblingIndex < spans.length; siblingIndex++) {\n      const sibling = spans[siblingIndex]\n\n      if (sibling.marks && Array.isArray(sibling.marks) && sibling.marks.indexOf(mark) !== -1) {\n        occurences[mark]++\n      } else {\n        break\n      }\n    }\n\n    return occurences\n  }, {})\n\n  const sortByOccurence = sortMarks.bind(null, markOccurences)\n\n  // Slicing because sort() mutates the input\n  return span.marks.slice().sort(sortByOccurence)\n}\n\nfunction sortMarks(occurences, markA, markB) {\n  const aOccurences = occurences[markA] || 0\n  const bOccurences = occurences[markB] || 0\n\n  if (aOccurences !== bOccurences) {\n    return bOccurences - aOccurences\n  }\n\n  const aDefaultPos = defaultMarks.indexOf(markA)\n  const bDefaultPos = defaultMarks.indexOf(markB)\n\n  // Sort default marks last\n  if (aDefaultPos !== bDefaultPos) {\n    return aDefaultPos - bDefaultPos\n  }\n\n  // Sort other marks simply by key\n  if (markA < markB) {\n    return -1\n  } else if (markA > markB) {\n    return 1\n  }\n\n  return 0\n}\n\nfunction isTextSpan(node) {\n  return (\n    node._type === 'span' &&\n    typeof node.text === 'string' &&\n    (Array.isArray(node.marks) || typeof node.marks === 'undefined')\n  )\n}\n\nfunction findLastParentNode(nodes) {\n  for (let i = nodes.length - 1; i >= 0; i--) {\n    const node = nodes[i]\n    if (node._type === 'span' && node.children) {\n      return node\n    }\n  }\n\n  return undefined\n}\n\nmodule.exports = buildMarksTree\n","const objectAssign = require('object-assign')\n\n/* eslint-disable max-depth, complexity */\nfunction nestLists(blocks, mode = 'html') {\n  const tree = []\n  let currentList\n\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i]\n    if (!isListBlock(block)) {\n      tree.push(block)\n      currentList = null\n      continue\n    }\n\n    // Start of a new list?\n    if (!currentList) {\n      currentList = listFromBlock(block)\n      tree.push(currentList)\n      continue\n    }\n\n    // New list item within same list?\n    if (blockMatchesList(block, currentList)) {\n      currentList.children.push(block)\n      continue\n    }\n\n    // Different list props, are we going deeper?\n    if (block.level > currentList.level) {\n      const newList = listFromBlock(block)\n\n      if (mode === 'html') {\n        // Because HTML is kinda weird, nested lists needs to be nested within list items\n        // So while you would think that we could populate the parent list with a new sub-list,\n        // We actually have to target the last list element (child) of the parent.\n        // However, at this point we need to be very careful - simply pushing to the list of children\n        // will mutate the input, and we don't want to blindly clone the entire tree.\n\n        // Clone the last child while adding our new list as the last child of it\n        const lastListItem = lastChild(currentList)\n        const newLastChild = objectAssign({}, lastListItem, {\n          children: lastListItem.children.concat(newList)\n        })\n\n        // Swap the last child\n        currentList.children[currentList.children.length - 1] = newLastChild\n      } else {\n        currentList.children.push(newList)\n      }\n\n      // Set the newly created, deeper list as the current\n      currentList = newList\n      continue\n    }\n\n    // Different list props, are we going back up the tree?\n    if (block.level < currentList.level) {\n      // Current list has ended, and we need to hook up with a parent of the same level and type\n      const match = findListMatching(tree[tree.length - 1], block)\n      if (match) {\n        currentList = match\n        currentList.children.push(block)\n        continue\n      }\n\n      // Similar parent can't be found, assume new list\n      currentList = listFromBlock(block)\n      tree.push(currentList)\n      continue\n    }\n\n    // Different list props, different list style?\n    if (block.listItem !== currentList.listItem) {\n      const match = findListMatching(tree[tree.length - 1], {level: block.level})\n      if (match && match.listItem === block.listItem) {\n        currentList = match\n        currentList.children.push(block)\n        continue\n      } else {\n        currentList = listFromBlock(block)\n        tree.push(currentList)\n        continue\n      }\n    }\n\n    // eslint-disable-next-line no-console\n    console.warn('Unknown state encountered for block', block)\n    tree.push(block)\n  }\n\n  return tree\n}\n\nfunction isListBlock(block) {\n  return Boolean(block.listItem)\n}\n\nfunction blockMatchesList(block, list) {\n  return block.level === list.level && block.listItem === list.listItem\n}\n\nfunction listFromBlock(block) {\n  return {\n    _type: 'list',\n    _key: `${block._key}-parent`,\n    level: block.level,\n    listItem: block.listItem,\n    children: [block]\n  }\n}\n\nfunction lastChild(block) {\n  return block.children && block.children[block.children.length - 1]\n}\n\nfunction findListMatching(rootNode, matching) {\n  const filterOnType = typeof matching.listItem === 'string'\n  if (\n    rootNode._type === 'list' &&\n    rootNode.level === matching.level &&\n    (filterOnType && rootNode.listItem === matching.listItem)\n  ) {\n    return rootNode\n  }\n\n  const node = lastChild(rootNode)\n  if (!node) {\n    return false\n  }\n\n  return findListMatching(node, matching)\n}\n\nmodule.exports = nestLists\n","const objectAssign = require('object-assign')\n\nmodule.exports = blocks => {\n  return blocks.map(block => {\n    if (block._key) {\n      return block\n    }\n\n    return objectAssign({_key: getStaticKey(block)}, block)\n  })\n}\n\nfunction getStaticKey(item) {\n  return checksum(JSON.stringify(item))\n    .toString(36)\n    .replace(/[^A-Za-z0-9]/g, '')\n}\n\n/* eslint-disable no-bitwise */\nfunction checksum(str) {\n  let hash = 0\n  const strlen = str.length\n  if (strlen === 0) {\n    return hash\n  }\n\n  for (let i = 0; i < strlen; i++) {\n    hash = (hash << 5) - hash + str.charCodeAt(i)\n    hash &= hash // Convert to 32bit integer\n  }\n\n  return hash\n}\n/* eslint-enable no-bitwise */\n","const React = require('react')\nconst {getSerializers} = require('@sanity/block-content-to-hyperscript/internals')\n\nconst renderNode = React.createElement\nconst {defaultSerializers, serializeSpan} = getSerializers(renderNode)\n\nmodule.exports = {\n  serializeSpan,\n  serializers: defaultSerializers,\n  renderProps: {nestMarks: true}\n}\n"],"sourceRoot":""}